#!/usr/bin/env python3
"""
CLI script to remove a site.

Usage: remove_site <tenant_tag> <service_type> [--skip-backup]

Arguments:
    tenant_tag      Unique identifier for the site
    service_type    Type of site: flarum, mediawiki, or wordpress

Options:
    --skip-backup   Skip backup before removal (for GDPR full deletion)
"""

import argparse
import asyncio
import sys
from pathlib import Path

# Add parent directory to path for imports
sys.path.insert(0, str(Path(__file__).parent.parent))

from site_manager import remove_site


def main():
    parser = argparse.ArgumentParser(description="Remove a tenant site")
    parser.add_argument("tenant_tag", help="Unique identifier for the site")
    parser.add_argument(
        "service_type",
        choices=["flarum", "mediawiki", "wordpress"],
        help="Type of site",
    )
    parser.add_argument(
        "--skip-backup",
        action="store_true",
        help="Skip backup before removal (for GDPR full deletion)",
    )

    args = parser.parse_args()

    try:
        asyncio.run(
            remove_site(
                tenant_tag=args.tenant_tag,
                service_type=args.service_type,
                skip_backup=args.skip_backup,
            )
        )
        print(f"Site removed successfully: {args.tenant_tag}")
    except Exception as e:
        print(f"Error removing site: {e}", file=sys.stderr)
        sys.exit(1)


if __name__ == "__main__":
    main()
